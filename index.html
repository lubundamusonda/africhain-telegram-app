<!DOCTYPE html>
<html>
<head>
    <title>AfriChain Connect - Zambia</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            padding: 30px 0;
        }
        
        .logo {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .subtitle {
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn {
            background: linear-gradient(90deg, #00C853, #64DD17);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF9800, #FF5722);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 30px 0;
        }
        
        .feature {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üå±</div>
            <h1>AfriChain Connect</h1>
            <p class="subtitle">Zambia's Agricultural & Energy Marketplace</p>
        </div>
        
        <div id="userSection" class="card">
            <div class="user-info">
                <div class="avatar" id="userAvatar">?</div>
                <div>
                    <h3 id="userName">Loading...</h3>
                    <p id="userId">Telegram ID: --</p>
                </div>
            </div>
            <p>Welcome to Africa's first integrated marketplace for sustainable agriculture and clean energy!</p>
        </div>
        
        <div class="card">
            <h2>Quick Actions</h2>
            <button class="btn" onclick="createFarmerProfile()">
                üë®‚Äçüåæ Create Farmer Profile
            </button>
            <button class="btn btn-secondary" onclick="browseProducts()">
                üîç Browse Marketplace
            </button>
            <button class="btn" onclick="checkCarbonCredits()">
                üåç Check Carbon Credits
            </button>
        </div>
        
        <div class="feature-grid">
            <div class="feature">
                <div class="feature-icon">üí∞</div>
                <h4>Instant Payments</h4>
                <p>Get paid directly via Telegram</p>
            </div>
            <div class="feature">
                <div class="feature-icon">üìà</div>
                <h4>Market Prices</h4>
                <p>Real-time crop & energy prices</p>
            </div>
            <div class="feature">
                <div class="feature-icon">üå§Ô∏è</div>
                <h4>Solar Projects</h4>
                <p>Invest in clean energy</p>
            </div>
            <div class="feature">
                <div class="feature-icon">üìä</div>
                <h4>Carbon Trading</h4>
                <p>Sell verified carbon credits</p>
            </div>
        </div>
        
        <div class="card">
            <h2>Getting Started</h2>
            <p><strong>Step 1:</strong> Create your farmer/buyer profile</p>
            <p><strong>Step 2:</strong> Browse or list products</p>
            <p><strong>Step 3:</strong> Connect with buyers/sellers</p>
            <p><strong>Step 4:</strong> Trade securely with AI verification</p>
        </div>
    </div>

    <script>
        // Telegram Mini-App Initialization
        let tg = window.Telegram.WebApp;
        
        // Expand to full screen
        tg.expand();
        
        // Set theme colors
        tg.setHeaderColor('#1e3c72');
        tg.setBackgroundColor('#1e3c72');
        
        // Get user data from Telegram
        const user = tg.initDataUnsafe.user;
        
        if (user) {
            document.getElementById('userName').textContent = 
                user.first_name + (user.last_name ? ' ' + user.last_name : '');
            document.getElementById('userId').textContent = 
                'Telegram ID: ' + user.id;
            
            // Create avatar from first letter
            const firstLetter = user.first_name ? user.first_name[0].toUpperCase() : 'U';
            document.getElementById('userAvatar').textContent = firstLetter;
            
            // Set avatar color based on user ID
            const colors = ['#FF9800', '#2196F3', '#4CAF50', '#9C27B0'];
            const colorIndex = user.id % colors.length;
            document.getElementById('userAvatar').style.background = 
                `linear-gradient(45deg, ${colors[colorIndex]}, ${colors[(colorIndex + 1) % colors.length]})`;
        }
        
        // Main Button (bottom button)
        tg.MainButton.setText('START TRADING');
        tg.MainButton.show();
        tg.MainButton.onClick(() => {
            tg.showAlert('Welcome to AfriChain Connect! Let\'s begin your journey.');
        });
        
        // App functions
        function createFarmerProfile() {
            tg.showPopup({
                title: 'Create Farmer Profile',
                message: 'Enter your farm details to get started:',
                buttons: [
                    {id: 'crops', type: 'default', text: 'üåΩ Crop Farmer'},
                    {id: 'livestock', type: 'default', text: 'üêÑ Livestock'},
                    {id: 'energy', type: 'ok', text: '‚òÄÔ∏è Energy Producer'}
                ]
            }, (buttonId) => {
                if (buttonId === 'crops') {
                    tg.showAlert('Let\'s set up your crop farm profile!');
                    // In real app, navigate to form
                }
            });
        }
        
        function browseProducts() {
            tg.showPopup({
                title: 'Browse Marketplace',
                message: 'What are you looking for?',
                buttons: [
                    {id: 'buy', type: 'default', text: 'üõí Buy Products'},
                    {id: 'sell', type: 'default', text: 'üí∞ Sell Products'},
                    {id: 'invest', type: 'ok', text: 'üìà Invest in Projects'}
                ]
            });
        }
        
        function checkCarbonCredits() {
            tg.showAlert('Carbon credit feature coming soon!\n\nThis will let you earn money by reducing emissions on your farm.');
        }
        
        // Send data back to bot (for future features)
        function sendDataToBot(data) {
            tg.sendData(JSON.stringify(data));
        }
        
        // Listen for events from Telegram
        tg.onEvent('viewportChanged', (data) => {
            console.log('Viewport changed:', data);
        });
        
        // Initialize completed
        tg.ready();
        console.log('AfriChain Connect Mini-App loaded successfully!');
    </script>
</body>
</html>